<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Binary Calculator | Professional Tool</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --primary-bg: #1a1a2e;
            --secondary-bg: #16213e;
            --display-bg: #0f3460;
            --button-bg: #0d7377;
            --button-hover: #14ffec;
            --operator-bg: #e94560;
            --operator-hover: #ff7a93;
            --memory-bg: #533483;
            --memory-hover: #9d65c9;
            --text-light: #ffffff;
            --text-dark: #333333;
            --ad-bg: #2d2d3a;
            --history-bg: rgba(15, 52, 96, 0.5);
            --border-radius: 12px;
            --shadow: 0 8px 16px rgba(0,0,0,0.3);
            --transition: all 0.3s ease;
            --font-size: 16px;
        }

        .light-mode {
            --primary-bg: #f0f2f5;
            --secondary-bg: #ffffff;
            --display-bg: #e3e7eb;
            --button-bg: #4a9d9c;
            --button-hover: #5dcecc;
            --operator-bg: #ff6b6b;
            --operator-hover: #ff8e8e;
            --memory-bg: #8a6cbc;
            --memory-hover: #a78fd1;
            --text-light: #333333;
            --text-dark: #ffffff;
            --ad-bg: #e9ecef;
            --history-bg: rgba(227, 231, 235, 0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: var(--font-size);
        }

        body {
            background: linear-gradient(135deg, var(--primary-bg), var(--secondary-bg));
            color: var(--text-light);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            line-height: 1.6;
            transition: var(--transition);
        }

        .container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            position: relative;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #14ffec, #0d7377);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .tagline {
            font-size: 1.1rem;
            opacity: 0.8;
            max-width: 600px;
            margin: 0 auto;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background: rgba(255,255,255,0.2);
            transform: rotate(30deg);
        }

        .ad-container {
            background-color: var(--ad-bg);
            border-radius: var(--border-radius);
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            box-shadow: var(--shadow);
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .ad-label {
            font-size: 0.8rem;
            opacity: 0.7;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ad-content {
            width: 100%;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(45deg, #2a2a3a, #3a3a4a);
            border-radius: 8px;
            color: #aaa;
            font-style: italic;
        }

        .calculator-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .calculator {
            background-color: var(--secondary-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 20px;
            flex: 1;
            min-width: 300px;
        }

        .display-container {
            background-color: var(--display-bg);
            padding: 20px;
            text-align: right;
            position: relative;
        }

        .mode-display {
            position: absolute;
            top: 10px;
            left: 20px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .calculation-display {
            font-size: 1.2rem;
            min-height: 27px;
            opacity: 0.7;
            margin-bottom: 5px;
            overflow-x: auto;
            white-space: nowrap;
        }

        .result-display {
            font-size: 2.5rem;
            font-weight: bold;
            min-height: 50px;
            overflow-x: auto;
            white-space: nowrap;
        }

        .buttons-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            padding: 15px;
        }

        .btn {
            background-color: var(--button-bg);
            color: var(--text-light);
            border: none;
            border-radius: 8px;
            padding: 18px 5px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            aspect-ratio: 1/1;
            position: relative;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-operator {
            background-color: var(--operator-bg);
        }

        .btn-operator:hover {
            background-color: var(--operator-hover);
        }

        .btn-bitwise {
            background-color: var(--memory-bg);
            font-size: 1rem;
        }

        .btn-bitwise:hover {
            background-color: var(--memory-hover);
        }

        .btn-equals {
            background: linear-gradient(45deg, #14ffec, #0d7377);
            color: var(--text-dark);
            font-weight: bold;
            grid-column: span 2;
            aspect-ratio: unset;
        }

        .btn-clear {
            background-color: #ff6b6b;
        }

        .btn-clear:hover {
            background-color: #ff8e8e;
        }

        .btn:hover {
            background-color: var(--button-hover);
            color: var(--text-dark);
        }

        .tooltip {
            position: absolute;
            top: -30px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .btn:hover .tooltip {
            opacity: 1;
        }

        .history-panel {
            background-color: var(--secondary-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            max-height: 500px;
        }

        .panel-title {
            margin-bottom: 15px;
            font-size: 1.3rem;
            color: #14ffec;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-list {
            background-color: var(--history-bg);
            border-radius: 8px;
            padding: 15px;
            flex: 1;
            overflow-y: auto;
            max-height: 400px;
        }

        .history-item {
            padding: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-family: 'Courier New', monospace;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .conversion-section {
            background-color: var(--secondary-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--shadow);
        }

        .conversion-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .conversion-box {
            background-color: var(--display-bg);
            border-radius: var(--border-radius);
            padding: 20px;
        }

        .conversion-title {
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: #14ffec;
        }

        .conversion-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        input, select, button {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
            background-color: rgba(0,0,0,0.2);
            color: var(--text-light);
        }

        .conversion-btn {
            background-color: var(--button-bg);
            color: white;
            border: none;
            cursor: pointer;
            padding: 12px;
            margin-top: 10px;
            transition: var(--transition);
        }

        .conversion-btn:hover {
            background-color: var(--button-hover);
            color: var(--text-dark);
        }

        .output-options {
            background-color: var(--secondary-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--shadow);
        }

        .output-title {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.3rem;
            color: #14ffec;
        }

        .output-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }

        .output-btn {
            background-color: var(--memory-bg);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 5px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .output-btn:hover {
            background-color: var(--memory-hover);
            transform: translateY(-2px);
        }

        .accessibility-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .accessibility-option {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 30px;
        }

        .font-size-controls {
            display: flex;
            gap: 5px;
        }

        .size-btn {
            background: rgba(255,255,255,0.15);
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .size-btn:hover {
            background: rgba(255,255,255,0.25);
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            font-size: 0.9rem;
            opacity: 0.7;
            max-width: 600px;
        }

        .error-message {
            color: #ff6b6b;
            text-align: center;
            min-height: 20px;
            margin-top: 5px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .calculator-container {
                flex-direction: column;
            }
            
            .buttons-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .btn-bitwise {
                font-size: 0.8rem;
                padding: 12px 2px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .result-display {
                font-size: 2rem;
            }
            
            .ad-container {
                height: 100px;
            }
        }

        @media (max-width: 480px) {
            .btn {
                padding: 14px 2px;
                font-size: 1rem;
            }
            
            .output-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Print styles */
        @media print {
            body * {
                visibility: hidden;
            }
            .calculator, .calculator * {
                visibility: visible;
            }
            .calculator {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Secure Binary Calculator</h1>
            <p class="tagline">Professional-grade tool for binary operations, conversions, and bitwise calculations</p>
            <button class="theme-toggle" id="theme-toggle">
                <i class="fas fa-moon"></i>
            </button>
        </header>

        <div class="ad-container">
            <div class="ad-label">Advertisement by Adsterra</div>
            <div class="ad-content">
                <p>Secure Ad Placement (728×90)</p>
            </div>
        </div>

        <div class="accessibility-bar">
            <div class="accessibility-option">
                <i class="fas fa-text-height"></i>
                <span>Font Size</span>
                <div class="font-size-controls">
                    <button class="size-btn" id="font-decrease">A-</button>
                    <button class="size-btn" id="font-reset">A</button>
                    <button class="size-btn" id="font-increase">A+</button>
                </div>
            </div>
            <div class="accessibility-option">
                <i class="fas fa-microchip"></i>
                <span>Bit Mode: <span id="bit-mode">32-bit</span></span>
            </div>
            <div class="accessibility-option">
                <i class="fas fa-exchange-alt"></i>
                <span>Base: <span id="base-display">Binary</span></span>
            </div>
        </div>

        <div class="calculator-container">
            <div class="calculator">
                <div class="display-container">
                    <div class="mode-display">BINARY MODE</div>
                    <div class="calculation-display" id="calculation"></div>
                    <div class="result-display" id="display">0</div>
                </div>
                <div class="error-message" id="error"></div>
                
                <div class="buttons-grid">
                    <!-- Bitwise functions -->
                    <button class="btn btn-bitwise" data-action="and">
                        AND
                        <span class="tooltip">Bitwise AND operation</span>
                    </button>
                    <button class="btn btn-bitwise" data-action="or">
                        OR
                        <span class="tooltip">Bitwise OR operation</span>
                    </button>
                    <button class="btn btn-bitwise" data-action="xor">
                        XOR
                        <span class="tooltip">Bitwise XOR operation</span>
                    </button>
                    <button class="btn btn-bitwise" data-action="not">
                        NOT
                        <span class="tooltip">Bitwise NOT operation</span>
                    </button>
                    <button class="btn btn-clear" data-action="clear">C</button>
                    
                    <!-- Shift operations -->
                    <button class="btn btn-bitwise" data-action="lshift">
                        &lt;&lt;
                        <span class="tooltip">Left shift</span>
                    </button>
                    <button class="btn btn-bitwise" data-action="rshift">
                        &gt;&gt;
                        <span class="tooltip">Right shift</span>
                    </button>
                    <button class="btn btn-operator" data-action="percent">%</button>
                    <button class="btn btn-operator" data-action="divide">÷</button>
                    <button class="btn btn-operator" data-action="multiply">×</button>
                    
                    <!-- Number pad -->
                    <button class="btn" data-number="1">1</button>
                    <button class="btn" data-number="0">0</button>
                    <button class="btn" data-action="binary">BIN</button>
                    <button class="btn btn-operator" data-action="subtract">−</button>
                    <button class="btn" data-number="7">7</button>
                    <button class="btn" data-number="8">8</button>
                    <button class="btn" data-number="9">9</button>
                    <button class="btn btn-operator" data-action="add">+</button>
                    <button class="btn" data-number="4">4</button>
                    <button class="btn" data-number="5">5</button>
                    <button class="btn" data-number="6">6</button>
                    <button class="btn" data-action="hex">HEX</button>
                    <button class="btn" data-number="1">1</button>
                    <button class="btn" data-number="2">2</button>
                    <button class="btn" data-number="3">3</button>
                    <button class="btn" data-action="decimal">DEC</button>
                    <button class="btn" data-action="flip">±</button>
                    <button class="btn" data-number="0">0</button>
                    <button class="btn" data-action="backspace">⌫</button>
                    <button class="btn btn-equals" data-action="equals">=</button>
                </div>
            </div>

            <div class="history-panel">
                <div class="panel-title">
                    <span>Calculation History</span>
                    <button class="size-btn" id="clear-history">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <div class="history-list" id="history-list">
                    <div class="history-item">History is empty</div>
                </div>
            </div>
        </div>

        <div class="ad-container">
            <div class="ad-label">Advertisement by Yllix</div>
            <div class="ad-content">
                <p>Responsive Ad (320×100)</p>
            </div>
        </div>

        <div class="conversion-section">
            <h3 class="panel-title">Number Base Conversion</h3>
            <div class="conversion-grid">
                <div class="conversion-box">
                    <h4 class="conversion-title">Binary Conversion</h4>
                    <div class="conversion-form">
                        <div class="input-group">
                            <label for="binary-input">Binary Input</label>
                            <input type="text" id="binary-input" placeholder="Enter binary number">
                        </div>
                        <button class="conversion-btn" id="to-decimal">Convert to Decimal</button>
                        <button class="conversion-btn" id="to-hex">Convert to Hexadecimal</button>
                    </div>
                </div>
                
                <div class="conversion-box">
                    <h4 class="conversion-title">Decimal Conversion</h4>
                    <div class="conversion-form">
                        <div class="input-group">
                            <label for="decimal-input">Decimal Input</label>
                            <input type="number" id="decimal-input" placeholder="Enter decimal number">
                        </div>
                        <button class="conversion-btn" id="to-binary">Convert to Binary</button>
                        <button class="conversion-btn" id="to-hex-from-dec">Convert to Hexadecimal</button>
                    </div>
                </div>
                
                <div class="conversion-box">
                    <h4 class="conversion-title">Hexadecimal Conversion</h4>
                    <div class="conversion-form">
                        <div class="input-group">
                            <label for="hex-input">Hexadecimal Input</label>
                            <input type="text" id="hex-input" placeholder="Enter hexadecimal number">
                        </div>
                        <button class="conversion-btn" id="to-binary-from-hex">Convert to Binary</button>
                        <button class="conversion-btn" id="to-decimal-from-hex">Convert to Decimal</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="output-options">
            <h3 class="output-title">Output & Sharing Options</h3>
            <div class="output-buttons">
                <button class="output-btn" data-format="print">
                    <i class="fas fa-print"></i>
                    <span>Print</span>
                </button>
                <button class="output-btn" data-format="pdf">
                    <i class="fas fa-file-pdf"></i>
                    <span>PDF</span>
                </button>
                <button class="output-btn" data-format="png">
                    <i class="fas fa-image"></i>
                    <span>PNG</span>
                </button>
                <button class="output-btn" data-format="txt">
                    <i class="fas fa-file-alt"></i>
                    <span>TXT</span>
                </button>
                <button class="output-btn" data-format="csv">
                    <i class="fas fa-file-csv"></i>
                    <span>CSV</span>
                </button>
                <button class="output-btn" data-format="share">
                    <i class="fas fa-share-alt"></i>
                    <span>Share</span>
                </button>
            </div>
        </div>
    </div>

    <footer>
        <p>Secure Binary Calculator v1.2 | All calculations processed locally | Ad refresh every 60 seconds</p>
        <p>This application adheres to strict privacy standards - no user data is shared with ad networks.</p>
    </footer>

    <script>
        // Calculator state
        const calculator = {
            displayValue: '0',
            firstOperand: null,
            waitingForSecondOperand: false,
            operator: null,
            bitMode: 32, // 8, 16, 32, or 64-bit
            currentBase: 'binary', // binary, decimal, hex
            history: []
        };

        // DOM Elements
        const display = document.getElementById('display');
        const calculationDisplay = document.getElementById('calculation');
        const errorDisplay = document.getElementById('error');
        const historyList = document.getElementById('history-list');
        const themeToggle = document.getElementById('theme-toggle');
        const bitModeDisplay = document.getElementById('bit-mode');
        const baseDisplay = document.getElementById('base-display');

        // Initialize calculator
        function initCalculator() {
            updateDisplay();
            loadHistory();
            
            // Event listeners for theme toggle
            themeToggle.addEventListener('click', toggleTheme);
            
            // Event listeners for font size controls
            document.getElementById('font-increase').addEventListener('click', () => {
                document.documentElement.style.fontSize = 'calc(var(--font-size) + 2px)';
            });
            
            document.getElementById('font-reset').addEventListener('click', () => {
                document.documentElement.style.fontSize = '16px';
            });
            
            document.getElementById('font-decrease').addEventListener('click', () => {
                document.documentElement.style.fontSize = 'calc(var(--font-size) - 2px)';
            });
            
            // Clear history button
            document.getElementById('clear-history').addEventListener('click', clearHistory);
            
            // Conversion buttons
            document.getElementById('to-decimal').addEventListener('click', () => convertBinary('decimal'));
            document.getElementById('to-hex').addEventListener('click', () => convertBinary('hex'));
            document.getElementById('to-binary').addEventListener('click', () => convertDecimal('binary'));
            document.getElementById('to-hex-from-dec').addEventListener('click', () => convertDecimal('hex'));
            document.getElementById('to-binary-from-hex').addEventListener('click', () => convertHex('binary'));
            document.getElementById('to-decimal-from-hex').addEventListener('click', () => convertHex('decimal'));
        }

        // Toggle between dark and light mode
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const icon = themeToggle.querySelector('i');
            if (document.body.classList.contains('light-mode')) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        }

        // Update display
        function updateDisplay() {
            display.textContent = calculator.displayValue;
            bitModeDisplay.textContent = `${calculator.bitMode}-bit`;
            baseDisplay.textContent = calculator.currentBase.charAt(0).toUpperCase() + calculator.currentBase.slice(1);
        }

        // Input digit
        function inputDigit(digit) {
            const { displayValue, waitingForSecondOperand } = calculator;
            
            if (waitingForSecondOperand) {
                calculator.displayValue = digit;
                calculator.waitingForSecondOperand = false;
            } else {
                calculator.displayValue = displayValue === '0' ? digit : displayValue + digit;
            }
            
            errorDisplay.textContent = '';
        }

        // Handle operator
        function handleOperator(nextOperator) {
            const { firstOperand, displayValue, operator } = calculator;
            let inputValue;
            
            if (calculator.currentBase === 'binary') {
                inputValue = parseInt(displayValue, 2);
            } else if (calculator.currentBase === 'hex') {
                inputValue = parseInt(displayValue, 16);
            } else {
                inputValue = parseFloat(displayValue);
            }
            
            if (operator && calculator.waitingForSecondOperand) {
                calculator.operator = nextOperator;
                calculationDisplay.textContent = `${firstOperand} ${nextOperator}`;
                return;
            }
            
            if (firstOperand === null) {
                calculator.firstOperand = inputValue;
            } else if (operator) {
                const result = performCalculation();
                calculator.displayValue = String(result);
                calculator.firstOperand = result;
            }
            
            calculator.waitingForSecondOperand = true;
            calculator.operator = nextOperator;
            calculationDisplay.textContent = `${calculator.firstOperand} ${nextOperator}`;
        }

        // Perform calculation
        function performCalculation() {
            const { firstOperand, operator, displayValue } = calculator;
            let inputValue;
            
            if (calculator.currentBase === 'binary') {
                inputValue = parseInt(displayValue, 2);
            } else if (calculator.currentBase === 'hex') {
                inputValue = parseInt(displayValue, 16);
            } else {
                inputValue = parseFloat(displayValue);
            }
            
            if (isNaN(firstOperand) || isNaN(inputValue)) return 0;
            
            let result;
            
            switch (operator) {
                case 'add':
                    result = firstOperand + inputValue;
                    break;
                case 'subtract':
                    result = firstOperand - inputValue;
                    break;
                case 'multiply':
                    result = firstOperand * inputValue;
                    break;
                case 'divide':
                    if (inputValue === 0) {
                        errorDisplay.textContent = 'Error: Division by zero';
                        return 0;
                    }
                    result = firstOperand / inputValue;
                    break;
                case 'and':
                    result = firstOperand & inputValue;
                    break;
                case 'or':
                    result = firstOperand | inputValue;
                    break;
                case 'xor':
                    result = firstOperand ^ inputValue;
                    break;
                case 'lshift':
                    result = firstOperand << inputValue;
                    break;
                case 'rshift':
                    result = firstOperand >> inputValue;
                    break;
                default:
                    return inputValue;
            }
            
            // Apply bit mask based on bit mode
            if (calculator.bitMode === 8) {
                result = result & 0xFF;
            } else if (calculator.bitMode === 16) {
                result = result & 0xFFFF;
            } else if (calculator.bitMode === 32) {
                result = result >>> 0; // Convert to unsigned 32-bit
            }
            
            // Store calculation in history
            const historyEntry = {
                expression: `${firstOperand} ${getOperatorSymbol(operator)} ${inputValue}`,
                result: result,
                base: calculator.currentBase,
                timestamp: new Date().toLocaleString()
            };
            
            calculator.history.push(historyEntry);
            addHistoryItem(historyEntry);
            saveHistory();
            
            return result;
        }

        // Get operator symbol for display
        function getOperatorSymbol(operator) {
            switch (operator) {
                case 'add': return '+';
                case 'subtract': return '−';
                case 'multiply': return '×';
                case 'divide': return '÷';
                case 'and': return 'AND';
                case 'or': return 'OR';
                case 'xor': return 'XOR';
                case 'lshift': return '<<';
                case 'rshift': return '>>';
                default: return '';
            }
        }

        // Handle special functions
        function handleSpecialFunction(action) {
            let displayValue;
            
            if (calculator.currentBase === 'binary') {
                displayValue = parseInt(calculator.displayValue, 2);
            } else if (calculator.currentBase === 'hex') {
                displayValue = parseInt(calculator.displayValue, 16);
            } else {
                displayValue = parseFloat(calculator.displayValue);
            }
            
            if (isNaN(displayValue)) {
                errorDisplay.textContent = 'Error: Invalid input';
                return;
            }
            
            switch (action) {
                case 'not':
                    // Apply bitwise NOT with current bit mode
                    if (calculator.bitMode === 8) {
                        displayValue = (~displayValue) & 0xFF;
                    } else if (calculator.bitMode === 16) {
                        displayValue = (~displayValue) & 0xFFFF;
                    } else if (calculator.bitMode === 32) {
                        displayValue = (~displayValue) >>> 0;
                    } else {
                        displayValue = ~displayValue;
                    }
                    break;
                case 'percent':
                    displayValue = displayValue / 100;
                    break;
                case 'flip':
                    displayValue = -displayValue;
                    break;
                case 'backspace':
                    if (calculator.displayValue.length === 1) {
                        calculator.displayValue = '0';
                    } else {
                        calculator.displayValue = calculator.displayValue.slice(0, -1);
                    }
                    return;
                case 'clear':
                    resetCalculator();
                    return;
                case 'binary':
                    calculator.currentBase = 'binary';
                    displayValue = parseInt(calculator.displayValue);
                    calculator.displayValue = displayValue.toString(2);
                    break;
                case 'decimal':
                    calculator.currentBase = 'decimal';
                    if (calculator.displayValue.startsWith('0x')) {
                        displayValue = parseInt(calculator.displayValue, 16);
                    } else if (calculator.displayValue.match(/^[01]+$/)) {
                        displayValue = parseInt(calculator.displayValue, 2);
                    } else {
                        displayValue = parseFloat(calculator.displayValue);
                    }
                    calculator.displayValue = displayValue.toString(10);
                    break;
                case 'hex':
                    calculator.currentBase = 'hex';
                    if (calculator.displayValue.match(/^[01]+$/)) {
                        displayValue = parseInt(calculator.displayValue, 2);
                    } else {
                        displayValue = parseFloat(calculator.displayValue);
                    }
                    calculator.displayValue = '0x' + displayValue.toString(16).toUpperCase();
                    break;
            }
            
            calculator.displayValue = displayValue.toString();
            updateDisplay();
        }

        // Reset calculator
        function resetCalculator() {
            calculator.displayValue = '0';
            calculator.firstOperand = null;
            calculator.waitingForSecondOperand = false;
            calculator.operator = null;
            calculationDisplay.textContent = '';
            errorDisplay.textContent = '';
            updateDisplay();
        }

        // Handle equals
        function handleEquals() {
            if (calculator.waitingForSecondOperand) return;
            
            const result = performCalculation();
            
            if (calculator.currentBase === 'binary') {
                calculator.displayValue = result.toString(2);
            } else if (calculator.currentBase === 'hex') {
                calculator.displayValue = '0x' + result.toString(16).toUpperCase();
            } else {
                calculator.displayValue = result.toString(10);
            }
            
            calculationDisplay.textContent += ` ${calculator.displayValue} =`;
            calculator.firstOperand = null;
            calculator.waitingForSecondOperand = true;
            updateDisplay();
        }

        // Conversion functions
        function convertBinary(target) {
            const input = document.getElementById('binary-input').value;
            if (!input.match(/^[01]+$/)) {
                errorDisplay.textContent = 'Error: Invalid binary input';
                return;
            }
            
            const decimal = parseInt(input, 2);
            let result;
            
            if (target === 'decimal') {
                result = decimal.toString(10);
            } else {
                result = '0x' + decimal.toString(16).toUpperCase();
            }
            
            calculator.displayValue = result;
            calculator.currentBase = target === 'decimal' ? 'decimal' : 'hex';
            updateDisplay();
            addConversionToHistory(input, 'binary', result, target);
        }

        function convertDecimal(target) {
            const input = document.getElementById('decimal-input').value;
            const decimal = parseFloat(input);
            
            if (isNaN(decimal)) {
                errorDisplay.textContent = 'Error: Invalid decimal input';
                return;
            }
            
            let result;
            
            if (target === 'binary') {
                result = decimal.toString(2);
            } else {
                result = '0x' + decimal.toString(16).toUpperCase();
            }
            
            calculator.displayValue = result;
            calculator.currentBase = target;
            updateDisplay();
            addConversionToHistory(input, 'decimal', result, target);
        }

        function convertHex(target) {
            const input = document.getElementById('hex-input').value;
            const hex = input.startsWith('0x') ? input.substring(2) : input;
            const decimal = parseInt(hex, 16);
            
            if (isNaN(decimal)) {
                errorDisplay.textContent = 'Error: Invalid hexadecimal input';
                return;
            }
            
            let result;
            
            if (target === 'binary') {
                result = decimal.toString(2);
            } else {
                result = decimal.toString(10);
            }
            
            calculator.displayValue = result;
            calculator.currentBase = target;
            updateDisplay();
            addConversionToHistory(input, 'hex', result, target);
        }

        // History functions
        function addConversionToHistory(input, from, result, to) {
            const historyEntry = {
                expression: `${input} (${from})`,
                result: `${result} (${to})`,
                timestamp: new Date().toLocaleString()
            };
            
            calculator.history.push(historyEntry);
            addHistoryItem(historyEntry);
            saveHistory();
        }

        function addHistoryItem(entry) {
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            historyItem.innerHTML = `
                <div><strong>${entry.expression}</strong> = ${entry.result}</div>
                <div style="font-size: 0.8rem; opacity: 0.7;">${entry.timestamp}</div>
            `;
            
            // If history is empty, remove the placeholder
            if (historyList.firstChild?.textContent === 'History is empty') {
                historyList.innerHTML = '';
            }
            
            historyList.prepend(historyItem);
        }

        function saveHistory() {
            localStorage.setItem('binaryCalcHistory', JSON.stringify(calculator.history));
        }

        function loadHistory() {
            const savedHistory = localStorage.getItem('binaryCalcHistory');
            if (savedHistory) {
                calculator.history = JSON.parse(savedHistory);
                calculator.history.forEach(addHistoryItem);
            }
        }

        function clearHistory() {
            calculator.history = [];
            historyList.innerHTML = '<div class="history-item">History is empty</div>';
            localStorage.removeItem('binaryCalcHistory');
        }

        // Event listeners for buttons
        document.querySelectorAll('.btn[data-number]').forEach(button => {
            button.addEventListener('click', () => {
                inputDigit(button.getAttribute('data-number'));
                updateDisplay();
            });
        });

        document.querySelectorAll('.btn[data-action]').forEach(button => {
            button.addEventListener('click', () => {
                const action = button.getAttribute('data-action');
                
                if (action === 'equals') {
                    handleEquals();
                } else if (['add', 'subtract', 'multiply', 'divide', 'and', 'or', 'xor', 'lshift', 'rshift'].includes(action)) {
                    handleOperator(action);
                } else {
                    handleSpecialFunction(action);
                }
                
                updateDisplay();
            });
        });

        // Output functions
        document.querySelectorAll('.output-btn').forEach(button => {
            button.addEventListener('click', () => {
                const format = button.getAttribute('data-format');
                
                switch (format) {
                    case 'print':
                        window.print();
                        break;
                    case 'pdf':
                        exportToPDF();
                        break;
                    case 'txt':
                        exportToTXT();
                        break;
                    case 'csv':
                        exportToCSV();
                        break;
                    case 'share':
                        shareResult();
                        break;
                }
            });
        });

        // Export to PDF
        function exportToPDF() {
            const element = document.querySelector('.calculator');
            const opt = {
                margin: 10,
                filename: 'binary_calculation.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            
            html2pdf().set(opt).from(element).save();
        }

        // Export to TXT
        function exportToTXT() {
            const content = `Binary Calculator Result\n\n` +
                           `Expression: ${calculationDisplay.textContent || 'N/A'}\n` +
                           `Result: ${display.textContent}\n` +
                           `Mode: ${calculator.bitMode}-bit\n` +
                           `Base: ${calculator.currentBase}\n` +
                           `Date: ${new Date().toLocaleString()}`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const link = document.createElement('a');
            link.download = 'binary_calculation.txt';
            link.href = URL.createObjectURL(blob);
            link.click();
        }

        // Export to CSV
        function exportToCSV() {
            let content = "Expression,Result,Base,Bit Mode,Timestamp\n";
            
            // Add current calculation
            content += `"${calculationDisplay.textContent || 'N/A'}","${display.textContent}",${calculator.currentBase},${calculator.bitMode},"${new Date().toLocaleString()}"\n`;
            
            // Add history
            calculator.history.forEach(item => {
                content += `"${item.expression}","${item.result}",${item.base || calculator.currentBase},${calculator.bitMode},"${item.timestamp}"\n`;
            });
            
            const blob = new Blob([content], { type: 'text/csv' });
            const link = document.createElement('a');
            link.download = 'binary_calculations.csv';
            link.href = URL.createObjectURL(blob);
            link.click();
        }

        // Share result
        function shareResult() {
            const expression = calculationDisplay.textContent || 'Current Calculation';
            const result = display.textContent;
            
            const shareData = {
                title: 'Binary Calculator Result',
                text: `${expression} = ${result} (${calculator.bitMode}-bit ${calculator.currentBase})`,
                url: window.location.href
            };
            
            if (navigator.share) {
                navigator.share(shareData).catch(console.error);
            } else {
                // Fallback for browsers without Web Share API
                prompt('Copy to clipboard: Ctrl+C, Enter', `${expression} = ${result}`);
            }
        }

        // Ad refresh simulation
        function refreshAds() {
            const ads = document.querySelectorAll('.ad-content');
            ads.forEach(ad => {
                ad.innerHTML = '<p>Advertisement refreshed</p>';
                setTimeout(() => {
                    ad.innerHTML = '<p>Secure Ad Placement</p>';
                }, 1000);
            });
        }

        // Periodically refresh ads (simulated)
        setInterval(refreshAds, 60000);

        // Initialize calculator
        window.addEventListener('DOMContentLoaded', initCalculator);
    </script>
</body>
</html>