<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional BAC Calculator | Blood Alcohol Content Estimation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #f8f9fa;
            --dark: #1a2530;
            --safe: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --border-radius: 10px;
            --box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f0f7ff, #e6f0ff);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            transition: var(--transition);
        }
        
        body.dark-mode {
            background: linear-gradient(135deg, #1a2530, #0d1b2a);
            color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--dark));
            color: white;
            padding: 25px 0;
            text-align: center;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--box-shadow);
            position: relative;
            overflow: hidden;
            border-bottom: 4px solid var(--accent);
        }
        
        header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: rotate(30deg);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
            position: relative;
        }
        
        .security-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 20px;
            border-radius: 30px;
            color: white;
            font-weight: 600;
            margin-top: 15px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .calculator-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .dark-mode .calculator-card {
            background: #1e2a38;
        }
        
        .calculator-card::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--secondary), var(--accent));
        }
        
        .card-title {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .dark-mode .card-title {
            border-bottom: 1px solid #2c3e50;
        }
        
        .card-title i {
            margin-right: 12px;
            color: var(--secondary);
            font-size: 1.8rem;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 768px) {
            .input-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        
        .dark-mode .input-group label {
            color: #f5f5f5;
        }
        
        .info-tooltip {
            margin-left: 8px;
            color: var(--secondary);
            cursor: pointer;
            position: relative;
        }
        
        .tooltip-text {
            position: absolute;
            bottom: 100%;
            left: 0;
            background: var(--dark);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.85rem;
            width: 250px;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .info-tooltip:hover .tooltip-text {
            opacity: 1;
            visibility: visible;
        }
        
        input, select {
            width: 100%;
            padding: 14px;
            border: 2px solid #e9ecef;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .dark-mode input, .dark-mode select {
            background: #2c3e50;
            border: 2px solid #34495e;
            color: #f5f5f5;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.2);
        }
        
        .drink-type {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .drink-icon {
            width: 40px;
            height: 40px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .calculate-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }
        
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }
        
        .results-section {
            background: linear-gradient(135deg, #f0f8ff, #e6f7ff);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-top: 25px;
            border-left: 5px solid var(--secondary);
            display: none;
        }
        
        .dark-mode .results-section {
            background: linear-gradient(135deg, #1a2a3a, #152532);
        }
        
        .bac-display {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .bac-value {
            font-size: 4rem;
            font-weight: 700;
            margin: 20px 0;
            transition: var(--transition);
        }
        
        .bac-status {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .progress-container {
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            margin: 30px 0;
            position: relative;
        }
        
        .dark-mode .progress-container {
            background: #2c3e50;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 15px;
            transition: width 0.5s ease;
            position: relative;
        }
        
        .progress-markers {
            display: flex;
            justify-content: space-between;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 0 10px;
        }
        
        .progress-marker {
            height: 100%;
            width: 2px;
            background: rgba(0,0,0,0.2);
            position: relative;
        }
        
        .marker-label {
            position: absolute;
            top: 35px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            white-space: nowrap;
        }
        
        .risk-levels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .risk-level {
            text-align: center;
            padding: 10px;
            border-radius: var(--border-radius);
            flex: 1;
            margin: 0 5px;
            font-weight: 600;
        }
        
        .risk-safe {
            background: rgba(39, 174, 96, 0.2);
            color: var(--safe);
        }
        
        .risk-caution {
            background: rgba(243, 156, 18, 0.2);
            color: var(--warning);
        }
        
        .risk-danger {
            background: rgba(231, 76, 60, 0.2);
            color: var(--danger);
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }
        
        .action-btn {
            background: var(--primary);
            color: white;
            border-radius: var(--border-radius);
            padding: 14px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .action-btn i {
            font-size: 1.4rem;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .action-btn.print {
            background: var(--secondary);
        }
        
        .action-btn.share {
            background: var(--accent);
        }
        
        .ad-container {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 20px;
            text-align: center;
            margin-bottom: 30px;
            min-height: 280px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-top: 5px solid var(--warning);
        }
        
        .dark-mode .ad-container {
            background: #1e2a38;
        }
        
        .ad-label {
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }
        
        .ad-placeholder {
            width: 100%;
            height: 250px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px dashed #dee2e6;
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #6c757d;
        }
        
        .dark-mode .ad-placeholder {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            border: 2px dashed #4a627a;
        }
        
        .ad-placeholder i {
            font-size: 3.5rem;
            margin-bottom: 15px;
            color: #ced4da;
        }
        
        .history-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            border-top: 5px solid var(--success);
        }
        
        .dark-mode .history-card {
            background: #1e2a38;
        }
        
        .history-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }
        
        .dark-mode .history-item {
            border-bottom: 1px solid #2c3e50;
        }
        
        .history-item:hover {
            background: #f8f9fa;
        }
        
        .dark-mode .history-item:hover {
            background: #2c3e50;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-icon {
            width: 40px;
            height: 40px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-right: 15px;
        }
        
        .history-details {
            flex: 1;
        }
        
        .history-bac {
            font-weight: 700;
            color: var(--secondary);
        }
        
        .history-time {
            font-size: 0.85rem;
            color: #7f8c8d;
        }
        
        .clear-history {
            background: transparent;
            color: var(--warning);
            border: 2px solid var(--warning);
            padding: 10px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            margin-top: 20px;
            width: auto;
            display: inline-block;
            font-weight: 600;
        }
        
        .clear-history:hover {
            background: var(--warning);
            color: white;
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 40px;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
        }
        
        .dark-mode footer {
            border-top: 1px solid #2c3e50;
        }
        
        .compliance-section {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .compliance-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #e8f4fc;
            padding: 8px 15px;
            border-radius: 30px;
            color: var(--info);
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .dark-mode .compliance-badge {
            background: #1a3a5f;
        }
        
        @media (max-width: 600px) {
            .action-buttons {
                grid-template-columns: 1fr 1fr;
            }
            
            header h1 {
                font-size: 2rem;
            }
        }
        
        .error-message {
            color: #e74c3c;
            background: #fdeded;
            padding: 10px;
            border-radius: var(--border-radius);
            margin: 15px 0;
            display: none;
        }
        
        .disclaimer {
            background: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 25px;
            font-size: 0.9rem;
            border-left: 3px solid var(--warning);
        }
        
        .dark-mode .disclaimer {
            background: #2c3e50;
        }
        
        .age-gate {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .age-verification {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 500px;
            text-align: center;
            box-shadow: var(--box-shadow);
        }
        
        .dark-mode .age-verification {
            background: #1e2a38;
        }
        
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 10px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            transition: var(--transition);
            z-index: 100;
        }
        
        .theme-toggle:hover {
            background: #1a2530;
        }
    </style>
</head>
<body>
    <div class="age-gate" id="ageGate">
        <div class="age-verification">
            <h3>Age Verification</h3>
            <p>This BAC calculator is intended for adults only. You must be at least 21 years old to use this tool.</p>
            <div class="input-group my-4">
                <label for="ageInput">Enter your age:</label>
                <input type="number" id="ageInput" class="form-control" min="1" max="120">
            </div>
            <button class="btn btn-primary" id="verifyAge">Verify Age</button>
            <p class="mt-3 text-muted">By using this calculator, you confirm that you are of legal drinking age in your country.</p>
        </div>
    </div>

    <div class="container" id="mainContent" style="display: none;">
        <button class="theme-toggle" id="themeToggle">
            <i class="fas fa-moon"></i> Dark Mode
        </button>
        
        <header>
            <h1><i class="fas fa-wine-glass-alt"></i> Professional BAC Calculator</h1>
            <p>Estimate your Blood Alcohol Content (BAC) with precision and safety</p>
            <div class="security-badge">
                <i class="fas fa-lock"></i> Secure Client-Side Processing • No Data Stored
            </div>
        </header>
        
        <div class="main-content">
            <div class="left-column">
                <div class="calculator-card">
                    <div class="card-title">
                        <i class="fas fa-calculator"></i>
                        <h2>BAC Calculation</h2>
                    </div>
                    
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="weight">
                                Weight 
                                <span class="info-tooltip">
                                    <i class="fas fa-info-circle"></i>
                                    <span class="tooltip-text">Enter your body weight in pounds or kilograms</span>
                                </span>
                            </label>
                            <input type="number" id="weight" placeholder="Enter weight" min="0" step="0.1">
                        </div>
                        
                        <div class="input-group">
                            <label for="gender">Gender</label>
                            <select id="gender">
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                        </div>
                        
                        <div class="input-group">
                            <label for="hours">
                                Hours Drinking 
                                <span class="info-tooltip">
                                    <i class="fas fa-info-circle"></i>
                                    <span class="tooltip-text">Total duration of alcohol consumption</span>
                                </span>
                            </label>
                            <input type="number" id="hours" placeholder="Enter hours" min="0" step="0.1">
                        </div>
                        
                        <div class="input-group">
                            <label>Drink Type</label>
                            <div class="drink-type">
                                <div class="drink-icon">
                                    <i class="fas fa-beer"></i>
                                </div>
                                <div style="flex: 1;">
                                    <label for="beer">Beer (5% ABV)</label>
                                    <input type="number" id="beer" placeholder="Number of beers" min="0" step="1">
                                </div>
                            </div>
                            
                            <div class="drink-type">
                                <div class="drink-icon">
                                    <i class="fas fa-wine-glass-alt"></i>
                                </div>
                                <div style="flex: 1;">
                                    <label for="wine">Wine (12% ABV)</label>
                                    <input type="number" id="wine" placeholder="Number of glasses" min="0" step="1">
                                </div>
                            </div>
                            
                            <div class="drink-type">
                                <div class="drink-icon">
                                    <i class="fas fa-glass-whiskey"></i>
                                </div>
                                <div style="flex: 1;">
                                    <label for="liquor">Liquor (40% ABV)</label>
                                    <input type="number" id="liquor" placeholder="Number of shots" min="0" step="1">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="error-message" id="errorMessage">
                        <i class="fas fa-exclamation-circle"></i> Please enter valid values for weight and hours
                    </div>
                    
                    <button class="calculate-btn" id="calculateBtn">
                        <i class="fas fa-calculator"></i> Calculate BAC
                    </button>
                    
                    <div class="results-section" id="resultsSection">
                        <div class="bac-display">
                            <div class="bac-value" id="bacValue">0.000</div>
                            <div class="bac-status" id="bacStatus">No Alcohol Detected</div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-bar" id="progressBar"></div>
                            <div class="progress-markers">
                                <div class="progress-marker" style="left: 0%"><span class="marker-label">0.00%</span></div>
                                <div class="progress-marker" style="left: 20%"><span class="marker-label">0.02%</span></div>
                                <div class="progress-marker" style="left: 40%"><span class="marker-label">0.05%</span></div>
                                <div class="progress-marker" style="left: 60%"><span class="marker-label">0.08%</span></div>
                                <div class="progress-marker" style="left: 80%"><span class="marker-label">0.15%</span></div>
                                <div class="progress-marker" style="left: 100%"><span class="marker-label">0.30%</span></div>
                            </div>
                        </div>
                        
                        <div class="risk-levels">
                            <div class="risk-level risk-safe">Safe<br>(0.00% - 0.05%)</div>
                            <div class="risk-level risk-caution">Caution<br>(0.05% - 0.08%)</div>
                            <div class="risk-level risk-danger">Danger<br>(0.08%+)</div>
                        </div>
                        
                        <div class="action-buttons">
                            <div class="action-btn print" id="printBtn">
                                <i class="fas fa-print"></i>
                                <span>Print</span>
                            </div>
                            <div class="action-btn" id="pdfBtn">
                                <i class="fas fa-file-pdf"></i>
                                <span>PDF</span>
                            </div>
                            <div class="action-btn" id="txtBtn">
                                <i class="fas fa-file-alt"></i>
                                <span>TXT</span>
                            </div>
                            <div class="action-btn" id="csvBtn">
                                <i class="fas fa-file-csv"></i>
                                <span>CSV</span>
                            </div>
                            <div class="action-btn share" id="shareBtn">
                                <i class="fas fa-share-alt"></i>
                                <span>Share</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="disclaimer">
                    <h5><i class="fas fa-exclamation-triangle"></i> Important Disclaimer</h5>
                    <p>This BAC calculator provides an estimate only and should not be used to determine if you're fit to drive or work. Many factors affect BAC, including metabolism, food consumption, and medication. This tool is not a substitute for professional medical or legal advice. Never drive under the influence of alcohol.</p>
                </div>
            </div>
            
            <div class="right-column">
                <div class="ad-container">
                    <div class="ad-label">Advertisement - Adsterra</div>
                    <div class="ad-placeholder">
                        <i class="fas fa-ad"></i>
                        <h3>Adsterra Ad Space</h3>
                        <p>300x250 Ad Banner</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">Responsive and secure ad integration</p>
                    </div>
                </div>
                
                <div class="ad-container">
                    <div class="ad-label">Advertisement - Yllix</div>
                    <div class="ad-placeholder">
                        <i class="fas fa-ad"></i>
                        <h3>Yllix Ad Space</h3>
                        <p>300x250 Ad Banner</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">Optimized for high CTR</p>
                    </div>
                </div>
                
                <div class="calculator-card">
                    <div class="card-title">
                        <i class="fas fa-history"></i>
                        <h2>Calculation History</h2>
                    </div>
                    <div id="historyList">
                        <p style="padding: 20px; text-align: center; color: #7f8c8d;">No calculation history yet</p>
                    </div>
                    <button class="clear-history" id="clearHistory">
                        <i class="fas fa-trash-alt"></i> Clear History
                    </button>
                </div>
                
                <div class="calculator-card">
                    <div class="card-title">
                        <i class="fas fa-info-circle"></i>
                        <h2>BAC Information</h2>
                    </div>
                    <div class="risk-levels">
                        <div class="risk-level risk-safe">0.00-0.05%<br>Mild effects</div>
                        <div class="risk-level risk-caution">0.05-0.08%<br>Impaired judgment</div>
                        <div class="risk-level risk-danger">0.08%+<br>Legally intoxicated</div>
                    </div>
                    <p class="mt-3">Factors affecting BAC:</p>
                    <ul style="padding-left: 20px;">
                        <li>Body weight and composition</li>
                        <li>Gender and metabolism</li>
                        <li>Food consumption</li>
                        <li>Medication interactions</li>
                        <li>Rate of alcohol consumption</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Professional BAC Calculator © 2023 | Blood Alcohol Content Estimation Tool</p>
            <div class="compliance-section">
                <div class="compliance-badge">
                    <i class="fas fa-lock"></i> SSL Secured
                </div>
                <div class="compliance-badge">
                    <i class="fas fa-user-shield"></i> GDPR/CCPA Compliant
                </div>
                <div class="compliance-badge">
                    <i class="fas fa-ban"></i> No Data Stored
                </div>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const ageGate = document.getElementById('ageGate');
            const mainContent = document.getElementById('mainContent');
            const ageInput = document.getElementById('ageInput');
            const verifyAgeBtn = document.getElementById('verifyAge');
            const themeToggle = document.getElementById('themeToggle');
            const weightInput = document.getElementById('weight');
            const genderSelect = document.getElementById('gender');
            const hoursInput = document.getElementById('hours');
            const beerInput = document.getElementById('beer');
            const wineInput = document.getElementById('wine');
            const liquorInput = document.getElementById('liquor');
            const calculateBtn = document.getElementById('calculateBtn');
            const errorMessage = document.getElementById('errorMessage');
            const resultsSection = document.getElementById('resultsSection');
            const bacValueEl = document.getElementById('bacValue');
            const bacStatusEl = document.getElementById('bacStatus');
            const progressBar = document.getElementById('progressBar');
            const printBtn = document.getElementById('printBtn');
            const pdfBtn = document.getElementById('pdfBtn');
            const txtBtn = document.getElementById('txtBtn');
            const csvBtn = document.getElementById('csvBtn');
            const shareBtn = document.getElementById('shareBtn');
            const historyList = document.getElementById('historyList');
            const clearHistoryBtn = document.getElementById('clearHistory');
            
            // State
            let calculationHistory = [];
            
            // Age verification
            verifyAgeBtn.addEventListener('click', function() {
                const age = parseInt(ageInput.value);
                if (age >= 21) {
                    ageGate.style.display = 'none';
                    mainContent.style.display = 'block';
                } else {
                    alert('You must be at least 21 years old to use this calculator.');
                }
            });
            
            // Theme toggle
            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                if (document.body.classList.contains('dark-mode')) {
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
                } else {
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
                }
            });
            
            // Calculate BAC
            calculateBtn.addEventListener('click', function() {
                const weight = parseFloat(weightInput.value);
                const hours = parseFloat(hoursInput.value);
                const beer = parseInt(beerInput.value) || 0;
                const wine = parseInt(wineInput.value) || 0;
                const liquor = parseInt(liquorInput.value) || 0;
                const gender = genderSelect.value;
                
                if (isNaN(weight) || weight <= 0 || isNaN(hours) || hours < 0) {
                    errorMessage.style.display = 'block';
                    return;
                }
                
                errorMessage.style.display = 'none';
                
                // Calculate total alcohol consumed (in ounces of pure alcohol)
                const beerAlcohol = beer * 0.6;  // 12 oz beer at 5% ABV
                const wineAlcohol = wine * 0.6;  // 5 oz wine at 12% ABV
                const liquorAlcohol = liquor * 0.6;  // 1.5 oz liquor at 40% ABV
                const totalAlcohol = beerAlcohol + wineAlcohol + liquorAlcohol;
                
                // Widmark formula for BAC
                const genderConstant = gender === 'male' ? 0.73 : 0.66;
                let bac = (totalAlcohol * 5.14 / (weight * genderConstant)) - (0.015 * hours);
                
                // Ensure BAC is not negative
                bac = Math.max(0, bac);
                
                // Format BAC value
                const formattedBAC = bac.toFixed(3);
                
                // Update display
                bacValueEl.textContent = formattedBAC;
                
                // Update status and progress bar
                updateBACStatus(bac);
                
                // Show results
                resultsSection.style.display = 'block';
                
                // Add to history
                addToHistory(formattedBAC, gender, totalAlcohol);
            });
            
            // Update BAC status and progress bar
            function updateBACStatus(bac) {
                // Calculate progress bar width (capped at 0.30% BAC)
                const progressWidth = Math.min(100, (bac / 0.30) * 100);
                progressBar.style.width = `${progressWidth}%`;
                
                // Set color and status based on BAC level
                if (bac === 0) {
                    bacStatusEl.textContent = "No Alcohol Detected";
                    progressBar.style.background = "#27ae60";
                    bacValueEl.style.color = "#27ae60";
                } else if (bac < 0.03) {
                    bacStatusEl.textContent = "Minimal Impairment";
                    progressBar.style.background = "#2ecc71";
                    bacValueEl.style.color = "#2ecc71";
                } else if (bac < 0.06) {
                    bacStatusEl.textContent = "Mild Impairment";
                    progressBar.style.background = "#f1c40f";
                    bacValueEl.style.color = "#f1c40f";
                } else if (bac < 0.08) {
                    bacStatusEl.textContent = "Significant Impairment";
                    progressBar.style.background = "#e67e22";
                    bacValueEl.style.color = "#e67e22";
                } else if (bac < 0.15) {
                    bacStatusEl.textContent = "Legally Intoxicated";
                    progressBar.style.background = "#e74c3c";
                    bacValueEl.style.color = "#e74c3c";
                } else if (bac < 0.25) {
                    bacStatusEl.textContent = "Severe Impairment";
                    progressBar.style.background = "#c0392b";
                    bacValueEl.style.color = "#c0392b";
                } else {
                    bacStatusEl.textContent = "Life-Threatening";
                    progressBar.style.background = "#7f1d1d";
                    bacValueEl.style.color = "#7f1d1d";
                }
            }
            
            // Add calculation to history
            function addToHistory(bac, gender, totalAlcohol) {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                historyItem.innerHTML = `
                    <div class="history-icon">
                        <i class="fas fa-${gender === 'male' ? 'mars' : 'venus'}"></i>
                    </div>
                    <div class="history-details">
                        <div class="history-bac">BAC: ${bac}%</div>
                        <div class="history-time">${new Date().toLocaleTimeString()}</div>
                    </div>
                    <div style="font-weight: 600; color: var(--secondary);">
                        ${totalAlcohol.toFixed(1)} oz
                    </div>
                `;
                
                if (historyList.querySelector('p')) {
                    historyList.innerHTML = '';
                }
                
                historyList.prepend(historyItem);
                
                // Store in history array
                calculationHistory.unshift({
                    bac,
                    gender,
                    totalAlcohol,
                    timestamp: new Date().toISOString()
                });
                
                // Keep only last 10 items
                if (calculationHistory.length > 10) {
                    calculationHistory.pop();
                    if (historyList.children.length > 10) {
                        historyList.removeChild(historyList.lastChild);
                    }
                }
            }
            
            // Clear history
            clearHistoryBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to clear all calculation history?')) {
                    historyList.innerHTML = '<p style="padding: 20px; text-align: center; color: #7f8c8d;">No calculation history</p>';
                    calculationHistory = [];
                }
            });
            
            // Export and sharing functions
            printBtn.addEventListener('click', function() {
                const printContent = document.getElementById('resultsSection').innerHTML;
                const originalContent = document.body.innerHTML;
                
                document.body.innerHTML = `
                    <div style="padding: 30px; font-family: Arial, sans-serif;">
                        <h2 style="color: #2c3e50; text-align: center; margin-bottom: 20px;">
                            BAC Calculator Report
                        </h2>
                        ${printContent}
                        <p style="margin-top: 30px; text-align: center; color: #7f8c8d; font-size: 0.9rem;">
                            This report is for estimation purposes only and should not be used to determine fitness to drive.
                        </p>
                    </div>
                `;
                
                window.print();
                document.body.innerHTML = originalContent;
            });
            
            pdfBtn.addEventListener('click', function() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                doc.setFontSize(18);
                doc.setTextColor(40, 40, 40);
                doc.text('BAC Calculator Report', 105, 20, null, null, 'center');
                
                doc.setFontSize(12);
                doc.setTextColor(100, 100, 100);
                doc.text(`Date: ${new Date().toLocaleDateString()}`, 15, 35);
                
                // Add results
                doc.setFontSize(14);
                doc.setTextColor(30, 30, 30);
                doc.text('BAC Calculation Results:', 15, 50);
                
                doc.setFontSize(12);
                doc.text(`Blood Alcohol Content (BAC): ${bacValueEl.textContent}%`, 20, 65);
                doc.text(`Status: ${bacStatusEl.textContent}`, 20, 75);
                doc.text(`Weight: ${weightInput.value} lbs`, 20, 85);
                doc.text(`Gender: ${genderSelect.options[genderSelect.selectedIndex].text}`, 20, 95);
                doc.text(`Hours: ${hoursInput.value} hours`, 20, 105);
                
                // Add disclaimer
                doc.setFontSize(10);
                doc.setTextColor(150, 150, 150);
                doc.text('This report is for estimation purposes only and should not be used to determine fitness to drive.', 15, 130, {maxWidth: 180});
                
                // Add footer
                doc.setFontSize(10);
                doc.setTextColor(150, 150, 150);
                doc.text('Generated by Professional BAC Calculator', 105, 280, null, null, 'center');
                
                doc.save('bac-report.pdf');
            });
            
            txtBtn.addEventListener('click', function() {
                const txtContent = 
                    `BAC Calculator Report\n` +
                    `=====================\n` +
                    `Date: ${new Date().toLocaleDateString()}\n\n` +
                    `Results:\n` +
                    `Blood Alcohol Content (BAC): ${bacValueEl.textContent}%\n` +
                    `Status: ${bacStatusEl.textContent}\n` +
                    `Weight: ${weightInput.value} lbs\n` +
                    `Gender: ${genderSelect.options[genderSelect.selectedIndex].text}\n` +
                    `Hours: ${hoursInput.value} hours\n\n` +
                    `Disclaimer:\n` +
                    `This report is for estimation purposes only and should not be used to determine fitness to drive.`;
                
                const blob = new Blob([txtContent], { type: 'text/plain' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'bac-report.txt';
                link.click();
            });
            
            csvBtn.addEventListener('click', function() {
                const csvContent = 
                    "Category,Value\n" +
                    `BAC,${bacValueEl.textContent}%\n` +
                    `Status,${bacStatusEl.textContent}\n` +
                    `Weight,${weightInput.value}\n` +
                    `Gender,${genderSelect.options[genderSelect.selectedIndex].text}\n` +
                    `Hours,${hoursInput.value}\n` +
                    `Date,${new Date().toLocaleDateString()}`;
                
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'bac-report.csv';
                link.click();
            });
            
            shareBtn.addEventListener('click', function() {
                const shareText = `BAC Calculation Results:
BAC: ${bacValueEl.textContent}%
Status: ${bacStatusEl.textContent}

Estimated with Professional BAC Calculator - For educational purposes only`;

                if (navigator.share) {
                    navigator.share({
                        title: 'BAC Calculation Results',
                        text: shareText
                    }).catch(console.error);
                } else {
                    // Fallback for browsers that don't support Web Share API
                    const textArea = document.createElement('textarea');
                    textArea.value = shareText;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    alert('Results copied to clipboard!');
                }
            });
        });
    </script>
</body>
</html>